<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Emmanuel Enwesi Foundation Quiz</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: #111827;
            color: #f3f4f6;
        }
        .container {
            max-width: 800px;
        }
        .bg-card {
            background-color: #1f2937;
        }
        .btn-primary {
            background-color: #071ca6;
            color: #ffffff;
        }
        .btn-primary:hover {
            background-color: #05126f;
        }
        .btn-secondary {
            background-color: #d40c31;
            color: #ffffff;
        }
        .btn-secondary:hover {
            background-color: #a40b2a;
        }
        .correct-answer {
            background-color: #10b981 !important;
            color: white;
            border-color: #047857;
        }
        .incorrect-answer {
            background-color: #ef4444 !important;
            color: white;
            border-color: #b91c1c;
        }
        .leaderboard-table {
            width: 100%;
            border-collapse: collapse;
        }
        .leaderboard-table th, .leaderboard-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #374151;
        }
        .leaderboard-table th {
            background-color: #374151;
        }
    </style>
</head>
<body class="p-4 flex flex-col items-center justify-center min-h-screen">
    <div class="logo-container mb-8 w-48">
        <img id="logo" src="logo.png" alt="Emmanuel Enwesi Foundation Logo" class="w-full h-auto">
    </div>
    <div id="app" class="container mx-auto p-8 rounded-xl shadow-lg bg-card border border-gray-700">
    </div>
    <footer class="mt-8 text-center text-gray-500 text-sm">
        <p>Developed by Emmanuel Enwesi Foundation</p>
    </footer>
    <script>
        // REPLACE THIS URL WITH YOUR DEPLOYED GOOGLE APPS SCRIPT URL
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbzhK0VJoDGLGw_juntJ-e94iQphYOPA0mKUu6uItxJVyre4JlkpKWjYj6OLBUBWknD52w/exec';

        const allQuizQuestions = [
    { question: "The address 8be2:4382:8d84:7ce2:ec0f:3908:d29a:903a is an:", options: ["Web address", "IPv4 address", "IPv6 address", "Mac address"], answer: "IPv6 address" },
    { question: "Which of the following canons is found in the ISC2 code of ethics?", options: ["Advance and promote the profession", "Protect society, the common good, and the infrastructure", "Provide diligent and competent service to principals", "Act honorably, honestly, safely and legally"], answer: "Provide diligent and competent service to principals" },
    { question: "Which of the following is NOT an ethical canon of the ISC2?", options: ["Advance and protect the profession", "Protect society, the common good, necessary public trust and confidence, and the infrastructure", "Act honorably, honestly, justly, responsibly and legally", "Provide active and qualified service to principal"], answer: "Provide active and qualified service to principal" },
    { question: "The cloud deployment model where a company has resources on-premise and in the cloud is known as:", options: ["Hybrid cloud", "Multi-tenant", "Private cloud", "Community cloud"], answer: "Hybrid cloud" },
    { question: "Which of the following is a public IP?", options: ["13.16.123.1", "192.168.123.1", "172.16.123.1", "10.221.123.1"], answer: "13.16.123.1" },
    { question: "Which of the following is a data handling policy procedure?", options: ["Transform", "Collect", "Encode", "Destroy"], answer: "Destroy" },
    { question: "Which devices would be more effective in detecting an intrusion into a network?", options: ["Routers", "HIDS", "Firewalls", "NIDS"], answer: "NIDS" },
    { question: "Which concept describes an information security strategy that integrates people, technology and operations across multiple layers?", options: ["Least Privilege", "Defense in Depth", "Separation of Duties", "Privileged Accounts"], answer: "Defense in Depth" },
    { question: "Which access control is more effective at protecting a door against unauthorized access?", options: ["Fences", "Turnstiles", "Barriers", "Locks"], answer: "Locks" },
    { question: "Which of the following is a detection control?", options: ["Turnstiles", "Smoke sensors", "Bollards", "Firewalls"], answer: "Smoke sensors" },
    { question: "Which type of attack has the PRIMARY objective of controlling the system from outside?", options: ["Backdoors", "Rootkits", "Cross-Site Scripting", "Trojans"], answer: "Backdoors" },
    { question: "Which of the following is not a protocol of the OSI Level 3?", options: ["SNMP", "ICMP", "IGMP", "IP"], answer: "SNMP" },
    { question: "When a company hires an insurance company to mitigate risk, which risk management technique is being applied?", options: ["Risk avoidance", "Risk transfer", "Risk mitigation", "Risk tolerance"], answer: "Risk transfer" },
    { question: "The SMTP protocol operates at OSI Level:", options: ["7", "25", "3", "23"], answer: "7" },
    { question: "The process of verifying or proving the user's identification is known as:", options: ["Confidentiality", "Integrity", "Authentication", "Authorization"], answer: "Authentication" },
    { question: "If an organization wants to protect itself against tailgating, which access control would be most effective?", options: ["Locks", "Fences", "Barriers", "Turnstiles"], answer: "Turnstiles" },
    { question: "Logging and monitoring systems are essential to:", options: ["Identifying inefficient performing systems, preventing compromises, and providing a record of how systems are used", "Identifying efficient performing systems, labeling compromises, and providing a record of how systems are used", "Identifying inefficient performing systems, detecting compromises, and providing a record of how systems are used", "Identifying efficient performing systems, detecting compromises, and providing a record of how systems are used"], answer: "Identifying inefficient performing systems, detecting compromises, and providing a record of how systems are used" },
    { question: "In the event of a disaster, which of these should be the PRIMARY objective?", options: ["Guarantee the safety of people", "Guarantee the continuity of critical systems", "Protection of the production database", "Application of disaster communication"], answer: "Guarantee the safety of people" },
    { question: "The process that ensures that system changes do not adversely impact business operations is known as:", options: ["Change Management", "Vulnerability Management", "Configuration Management", "Inventory Management"], answer: "Change Management" },
    { question: "The last phase in the data security cycle is:", options: ["Encryption", "Backup", "Archival", "Destruction"], answer: "Destruction" },
    { question: "Which access control model specifies access to an object based on the subject's role in the organization?", options: ["RBAC", "MAC", "DAC", "ABAC"], answer: "RBAC" },
    { question: "Which of the following is NOT an example of a physical security control?", options: ["Firewalls", "Biometric access controls", "Remote control electronic locks", "Security cameras"], answer: "Firewalls" },
    { question: "Which type of attack will most effectively maintain remote access and control over the victim's computer?", options: ["Trojans", "Phishing", "Cross-Site Scripting", "Rootkits"], answer: "Rootkits" },
    { question: "In incident terminology, the meaning of Zero Day is:", options: ["Days to solve a previously unknown system vulnerability", "A previously unknown system vulnerability", "Days without a cybersecurity incident", "Days with a cybersecurity incident"], answer: "A previously unknown system vulnerability" },
    { question: "Which of the following is NOT a possible model for an Incident Response Team (IRT)?", options: ["Leveraged", "Pre-existing", "Dedicated", "Hybrid"], answer: "Pre-existing" },
    { question: "A device found not to comply with the security baseline should be:", options: ["Disabled or separated into a quarantine area until a virus scan can be run", "Disabled or isolated into a quarantine area until it can be checked and updated", "Placed in a DMZ until it can be reviewed and updated", "Marked as potentially vulnerable and placed in a quarantine area"], answer: "Disabled or isolated into a quarantine area until it can be checked and updated" },
    { question: "A biometric reader that grants access to a computer system in a data center is a:", options: ["Administrative Control", "Physical Control", "Authorization Control", "Technical Control"], answer: "Physical Control" },
    { question: "Which type of attack PRIMARILY aims to make a resource inaccessible to its intended users?", options: ["Denial of Service", "Phishing", "Trojans", "Cross-Site Scripting"], answer: "Denial of Service" },
    { question: "Which type of attack embeds malicious payload inside a reputable or trusted software?", options: ["Trojans", "Phishing", "Rootkits", "Cross-Site Scripting"], answer: "Trojans" },
    { question: "Which tool is commonly used to sniff network traffic?", options: ["Burp Suite", "John the Ripper", "Wireshark", "Nslookup"], answer: "Wireshark" },
    { question: "Which of these is not an attack against an IP network?", options: ["Side-channel Attack", "Man-in-the-middle Attack", "Fragmented Packet Attack", "Oversized Packet Attack"], answer: "Side-channel Attack" },
    { question: "The detailed steps to complete tasks supporting departmental or organizational policies are typically documented in:", options: ["Regulations", "Standards", "Policies", "Procedures"], answer: "Procedures" },
    { question: "Which device is used to connect a LAN to the Internet?", options: ["SIEM", "HIDS", "Router", "Firewall"], answer: "Router" },
    { question: "What does SIEM mean?", options: ["Security Information and Enterprise Manager", "Security Information and Event Manager", "System Information and Enterprise Manager", "System Information and Event Manager"], answer: "Security Information and Event Manager" },
    { question: "A Security safeguard is the same as a:", options: ["Safety control", "Privacy control", "Security control", "Security principle"], answer: "Security control" },
    { question: "Which access control model can grant access to a given object based on complex rules?", options: ["DAC", "ABAC", "RBAC", "MAC"], answer: "ABAC" },
    { question: "Which port is used to secure communication over the web (HTTPS)?", options: ["69", "80", "25", "443"], answer: "443" },
    { question: "Which of these has the PRIMARY objective of identifying and prioritizing critical business processes?", options: ["Business Impact Plan", "Business Impact Analysis", "Disaster Recovery Plan", "Business Continuity Plan"], answer: "Business Impact Analysis" },
    { question: "Which of the following are NOT types of security controls?", options: ["Common controls", "Hybrid controls", "System-specific controls", "Storage controls"], answer: "Storage controls" },
    { question: "Which of the following is NOT a type of learning activity used in Security Awareness?", options: ["Awareness", "Training", "Education", "Tutorial"], answer: "Tutorial" },
    { question: "The magnitude of the harm expected as a result of an unauthorized disclosure, modification, destruction, or loss of information is known as:", options: ["Vulnerability", "Threat", "Impact", "Likelihood"], answer: "Impact" },
    { question: "The implementation of Security Controls is a form of:", options: ["Risk reduction", "Risk acceptance", "Risk avoidance", "Risk transference"], answer: "Risk reduction" },
    { question: "Which of the following attacks take advantage of poor input validation in websites?", options: ["Trojans", "Cross-Site Scripting", "Phishing", "Rootkits"], answer: "Cross-Site Scripting" },
    { question: "Which of the following is an example of an administrative security control?", options: ["Access Control Lists", "Acceptable Use Policies", "Badge Readers", "No entry signs"], answer: "Acceptable Use Policies" },
    { question: "In Change Management, which component addresses the procedures needed to undo changes?", options: ["Request for Approval", "Request for Change", "Rollback", "Disaster and Recover"], answer: "Rollback" },
    { question: "Which of the following properties is NOT guaranteed by Digital Signatures?", options: ["Authentication", "Confidentiality", "Non-Repudiation", "Integrity"], answer: "Confidentiality" },
    { question: "Which devices have the PRIMARY objective of collecting and analyzing security events?", options: ["Hubs", "Firewalls", "Routers", "SIEM"], answer: "SIEM" },
    { question: "What is an effective way of hardening a system?", options: ["Patch the system", "Have an IDS in place", "Run a vulnerability scan", "Create a DMZ for web application services"], answer: "Patch the system" },
    { question: "Which type of key can be used to both encrypt and decrypt the same message?", options: ["A public key", "A private key", "An asymmetric key", "A symmetric key"], answer: "A symmetric key" },
    { question: "Which regulations address data protection and privacy in Europe?", options: ["SOX", "HIPAA", "FISMA", "GDPR"], answer: "GDPR" }
];

        let currentQuestionIndex = 0;
        let score = 0;
        let userName = '';
        let timer = null;
        let timeLeft = 15;
        let quizQuestions = [];
        const app = document.getElementById('app');

        window.onload = () => {
            document.getElementById('logo').src = "logo.png";
            renderWelcomeScreen();
        };

        function shuffleArray(array) {
            return array.sort(() => Math.random() - 0.5);
        }

        function renderWelcomeScreen() {
            app.innerHTML = `
                <div class="text-center">
                    <h1 class="text-4xl font-bold mb-4 text-white">Emmanuel Enwesi Foundation Week 1 Quiz 🏆</h1>
                    <p class="text-lg text-gray-300 mb-6">Test your knowledge on cybersecurity fundamentals!</p>
                    <input type="text" id="userNameInput" placeholder="Enter your name e.g 'Emmanuel Enwesi Group X'" class="w-full md:w-2/3 px-4 py-2 rounded-md bg-gray-700 text-white border border-gray-600 mb-4 focus:outline-none focus:ring-2 focus:ring-[#071ca6]">
                    <button onclick="startGame()" class="btn-primary w-full md:w-1/2 py-3 rounded-md text-lg font-semibold transition duration-300 ease-in-out transform hover:scale-105">Start Quiz</button>
                    <button onclick="renderLeaderboard()" class="btn-secondary w-full md:w-1/2 py-3 mt-4 rounded-md text-lg font-semibold transition duration-300 ease-in-out transform hover:scale-105">View Leaderboard</button>
                </div>
            `;
        }

        function renderQuestion() {
            if (currentQuestionIndex >= 20) {
                endGame();
                return;
            }
            const questionData = quizQuestions[currentQuestionIndex];
            app.innerHTML = `
                <div class="text-center mb-6">
                    <h2 class="text-3xl font-bold text-white">Question ${currentQuestionIndex + 1} of 20</h2>
                    <p class="text-lg text-gray-400 mt-2">Time left: <span id="timer" class="font-bold" style="color: #071ca6;">15</span>s</p>
                    <div class="w-full bg-gray-700 rounded-full h-2.5 mt-2">
                        <div id="progressBar" class="h-2.5 rounded-full" style="background-color: #d40c31; width: 100%;"></div>
                    </div>
                </div>
                <div class="p-6 bg-gray-800 rounded-lg shadow-md border border-gray-700">
                    <p class="text-xl font-medium mb-6 text-gray-200">${questionData.question}</p>
                    <div id="options-container" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        ${questionData.options.map(option => `
                            <button class="option-btn bg-gray-700 text-white border border-gray-600 rounded-lg p-4 text-left transition duration-200 ease-in-out transform hover:bg-gray-600 hover:scale-105" data-option="${option}">
                                ${option}
                            </button>
                        `).join('')}
                    </div>
                </div>
            `;
            document.querySelectorAll('.option-btn').forEach(button => {
                button.addEventListener('click', handleAnswer);
            });
            startTimer();
        }

        async function renderLeaderboard() {
            app.innerHTML = `
                <div class="text-center mb-6">
                    <h2 class="text-3xl font-bold text-white">Leaderboard 🥇</h2>
                    <p class="text-lg text-gray-400 mt-2">Loading...</p>
                </div>
            `;
            try {
                const response = await fetch(`${SCRIPT_URL}?action=getLeaderboard`);
                const leaderboard = await response.json();

                app.innerHTML = `
                    <div class="text-center mb-6">
                        <h2 class="text-3xl font-bold text-white">Leaderboard 🥇</h2>
                    </div>
                    <div class="bg-gray-800 rounded-lg shadow-md overflow-hidden border border-gray-700">
                        <table class="leaderboard-table">
                            <thead>
                                <tr>
                                    <th class="text-gray-300">Rank</th>
                                    <th class="text-gray-300">Name</th>
                                    <th class="text-gray-300">Score</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${leaderboard.map((player, index) => `
                                    <tr class="${index % 2 === 0 ? 'bg-gray-800' : 'bg-gray-700'}">
                                        <td class="font-bold text-lg" style="color: #071ca6;">${index + 1}</td>
                                        <td>${player.name}</td>
                                        <td>${player.score}</td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                    <div class="text-center mt-6">
                        <button onclick="renderWelcomeScreen()" class="btn-primary w-full md:w-1/2 py-3 rounded-md text-lg font-semibold transition duration-300 ease-in-out transform hover:scale-105">Back to Home</button>
                    </div>
                `;
            } catch (error) {
                app.innerHTML = `
                    <div class="text-center">
                        <h2 class="text-3xl font-bold text-red-500">Error fetching leaderboard 😟</h2>
                        <p class="text-lg text-gray-400 mt-2">Please try again later.</p>
                        <button onclick="renderWelcomeScreen()" class="btn-primary w-full md:w-1/2 py-3 rounded-md text-lg font-semibold transition duration-300 ease-in-out transform hover:scale-105">Back to Home</button>
                    </div>
                `;
                console.error("Failed to fetch leaderboard:", error);
            }
        }

        function renderEndScreen() {
            app.innerHTML = `
                <div class="text-center">
                    <h2 class="text-4xl font-bold text-white mb-4">Quiz Complete! 🎉</h2>
                    <p class="text-2xl text-gray-300 mb-6">${userName}, your final score is: <span class="font-extrabold" style="color: #071ca6;">${score}</span> out of 20</p>
                    <button onclick="renderWelcomeScreen()" class="btn-primary w-full md:w-1/2 py-3 rounded-md text-lg font-semibold transition duration-300 ease-in-out transform hover:scale-105">Play Again</button>
                    <button onclick="renderLeaderboard()" class="btn-secondary w-full md:w-1/2 py-3 mt-4 rounded-md text-lg font-semibold transition duration-300 ease-in-out transform hover:scale-105">View Leaderboard</button>
                </div>
            `;
            confetti({
                particleCount: 150,
                spread: 70,
                origin: { y: 0.6 }
            });
        }

        function startGame() {
            userName = document.getElementById('userNameInput').value.trim();
            if (!userName) {
                alert('Please enter your name to start!');
                return;
            }
            currentQuestionIndex = 0;
            score = 0;
            quizQuestions = shuffleArray([...allQuizQuestions]).slice(0, 20);
            renderQuestion();
        }

        function handleAnswer(event) {
            clearInterval(timer);
            const selectedOption = event.target.getAttribute('data-option');
            const correctAnswer = quizQuestions[currentQuestionIndex].answer;
            document.querySelectorAll('.option-btn').forEach(button => {
                button.disabled = true;
                if (button.getAttribute('data-option') === correctAnswer) {
                    button.classList.add('correct-answer');
                } else if (button.getAttribute('data-option') === selectedOption) {
                    button.classList.add('incorrect-answer');
                }
            });

            if (selectedOption === correctAnswer) score++;

            setTimeout(() => {
                currentQuestionIndex++;
                renderQuestion();
            }, 1500);
        }

        function startTimer() {
            timeLeft = 15;
            const progressBar = document.getElementById('progressBar');
            const timerElement = document.getElementById('timer');
            timerElement.textContent = timeLeft;
            progressBar.style.width = `${(timeLeft / 15) * 100}%`;

            timer = setInterval(() => {
                timeLeft--;
                timerElement.textContent = timeLeft;
                progressBar.style.width = `${(timeLeft / 15) * 100}%`;
                if (timeLeft <= 0) {
                    clearInterval(timer);
                    currentQuestionIndex++;
                    renderQuestion();
                }
            }, 1000);
        }

        function endGame() {
            saveScore(userName, score);
            renderEndScreen();
        }

        async function saveScore(name, score) {
            try {
                const response = await fetch(`${SCRIPT_URL}?action=addScore&name=${encodeURIComponent(name)}&score=${score}`);
                const result = await response.json();
                console.log(result);
            } catch (error) {
                console.error("Failed to save score:", error);
            }
        }
    </script>
</body>
</html>
